[2025-05-18 08:12:48.704 +03:00] [INF] [] [] [] [Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `m`.`Id`, `m`.`BillRefNumber`, `m`.`BusinessShortCode`, `m`.`CreatedAt`, `m`.`FirstName`, `m`.`InvoiceNumber`, `m`.`IsVerified`, `m`.`LastName`, `m`.`MSISDN`, `m`.`MiddleName`, `m`.`OrgAccountBalance`, `m`.`RetryCount`, `m`.`ThirdPartyTransID`, `m`.`TransAmount`, `m`.`TransID`, `m`.`TransTime`, `m`.`TransactionType`, `m`.`VerificationDate`, `m`.`VerificationResult`
FROM `MpesaC2Bs` AS `m`
WHERE NOT (`m`.`IsVerified`) AND (`m`.`CreatedAt` > DATE_ADD(UTC_TIMESTAMP(), INTERVAL CAST(-7.0 AS signed) day))] []
[2025-05-18 08:12:52.754 +03:00] [WRN] [] [] [] [The WebRootPath was not found: C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\wwwroot. Static files may be unavailable.] []
[2025-05-18 08:12:52.823 +03:00] [INF] [] [] [] [Now listening on: https://localhost:5003] []
[2025-05-18 08:12:52.892 +03:00] [INF] [] [] [] [Application started. Press Ctrl+C to shut down.] []
[2025-05-18 08:12:52.902 +03:00] [INF] [] [] [] [Hosting environment: Development] []
[2025-05-18 08:12:52.904 +03:00] [INF] [] [] [] [Content root path: C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI] []
[2025-05-18 08:12:53.621 +03:00] [INF] [] [0HNCLPAI5CTU8:00000001] [/swagger/index.html] [Request starting HTTP/2 GET https://localhost:5003/swagger/index.html - null null] []
[2025-05-18 08:12:53.841 +03:00] [INF] [] [0HNCLPAI5CTU8:00000001] [/swagger/index.html] [Request finished HTTP/2 GET https://localhost:5003/swagger/index.html - 200 null text/html;charset=utf-8 232.2291ms] []
[2025-05-18 08:12:53.846 +03:00] [INF] [] [0HNCLPAI5CTU8:00000003] [/_framework/aspnetcore-browser-refresh.js] [Request starting HTTP/2 GET https://localhost:5003/_framework/aspnetcore-browser-refresh.js - null null] []
[2025-05-18 08:12:53.853 +03:00] [INF] [] [0HNCLPAI5CTU8:00000005] [/_vs/browserLink] [Request starting HTTP/2 GET https://localhost:5003/_vs/browserLink - null null] []
[2025-05-18 08:12:53.885 +03:00] [INF] [] [0HNCLPAI5CTU8:00000003] [/_framework/aspnetcore-browser-refresh.js] [Request finished HTTP/2 GET https://localhost:5003/_framework/aspnetcore-browser-refresh.js - 200 16503 application/javascript; charset=utf-8 39.6867ms] []
[2025-05-18 08:12:53.932 +03:00] [INF] [] [0HNCLPAI5CTU8:00000005] [/_vs/browserLink] [Request finished HTTP/2 GET https://localhost:5003/_vs/browserLink - 200 null text/javascript; charset=UTF-8 79.3649ms] []
[2025-05-18 08:12:54.206 +03:00] [INF] [] [0HNCLPAI5CTU8:00000007] [/swagger/v1/swagger.json] [Request starting HTTP/2 GET https://localhost:5003/swagger/v1/swagger.json - null null] []
[2025-05-18 08:12:54.315 +03:00] [INF] [] [0HNCLPAI5CTU8:00000007] [/swagger/v1/swagger.json] [Request finished HTTP/2 GET https://localhost:5003/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 109.3422ms] []
[2025-05-18 08:21:50.776 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Request starting HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - null 0] []
[2025-05-18 08:21:50.840 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [CORS policy execution successful.] []
[2025-05-18 08:21:50.857 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Executing endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:21:50.877 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Route matched with {action = "RegisterUrls", controller = "MpesaRegistration"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUrls() on controller DarajaAPI.Controllers.v1.MpesaRegistrationController (DarajaAPI).] []
[2025-05-18 08:22:03.949 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Executed action DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI) in 13062.565ms] []
[2025-05-18 08:22:03.955 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Executed endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:22:03.963 +03:00] [ERR] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [An unhandled exception has occurred while executing the request.] [System.ArgumentNullException: Value cannot be null. (Parameter 'uriString')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Uri..ctor(String uriString)
   at Program.<>c__DisplayClass0_0.<<Main>$>b__1(HttpClient client) in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Program.cs:line 49
   at Microsoft.Extensions.Http.DefaultHttpClientFactory.CreateClient(String name)
   at DarajaAPI.Services.Daraja.DarajaAuthService.GetAccessTokenAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaAuthService.cs:line 22
   at DarajaAPI.Services.Daraja.DarajaRegistrationService.RegisterUrlsAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaRegistrationService.cs:line 24
   at DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Controllers\v1\MpesaRegistrationController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
]
[2025-05-18 08:22:04.028 +03:00] [INF] [] [0HNCLPAI5CTU8:00000009] [/api/v1/mpesa/registration/urls] [Request finished HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - 500 null text/plain; charset=utf-8 13252.8022ms] []
[2025-05-18 08:22:31.659 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Request starting HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - null 0] []
[2025-05-18 08:22:31.675 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [CORS policy execution successful.] []
[2025-05-18 08:22:31.679 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Executing endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:22:31.681 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Route matched with {action = "RegisterUrls", controller = "MpesaRegistration"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUrls() on controller DarajaAPI.Controllers.v1.MpesaRegistrationController (DarajaAPI).] []
[2025-05-18 08:22:34.643 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Executed action DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI) in 2958.9167ms] []
[2025-05-18 08:22:34.645 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Executed endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:22:34.647 +03:00] [ERR] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [An unhandled exception has occurred while executing the request.] [System.ArgumentNullException: Value cannot be null. (Parameter 'uriString')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Uri..ctor(String uriString)
   at Program.<>c__DisplayClass0_0.<<Main>$>b__1(HttpClient client) in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Program.cs:line 49
   at Microsoft.Extensions.Http.DefaultHttpClientFactory.CreateClient(String name)
   at DarajaAPI.Services.Daraja.DarajaAuthService.GetAccessTokenAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaAuthService.cs:line 22
   at DarajaAPI.Services.Daraja.DarajaRegistrationService.RegisterUrlsAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaRegistrationService.cs:line 24
   at DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Controllers\v1\MpesaRegistrationController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
]
[2025-05-18 08:22:34.661 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000B] [/api/v1/mpesa/registration/urls] [Request finished HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - 500 null text/plain; charset=utf-8 3001.6367ms] []
[2025-05-18 08:27:52.742 +03:00] [INF] [] [] [] [Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `m`.`Id`, `m`.`BillRefNumber`, `m`.`BusinessShortCode`, `m`.`CreatedAt`, `m`.`FirstName`, `m`.`InvoiceNumber`, `m`.`IsVerified`, `m`.`LastName`, `m`.`MSISDN`, `m`.`MiddleName`, `m`.`OrgAccountBalance`, `m`.`RetryCount`, `m`.`ThirdPartyTransID`, `m`.`TransAmount`, `m`.`TransID`, `m`.`TransTime`, `m`.`TransactionType`, `m`.`VerificationDate`, `m`.`VerificationResult`
FROM `MpesaC2Bs` AS `m`
WHERE NOT (`m`.`IsVerified`) AND (`m`.`CreatedAt` > DATE_ADD(UTC_TIMESTAMP(), INTERVAL CAST(-7.0 AS signed) day))] []
[2025-05-18 08:28:40.614 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Request starting HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - null 0] []
[2025-05-18 08:28:40.628 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [CORS policy execution successful.] []
[2025-05-18 08:28:40.633 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Executing endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:28:40.636 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Route matched with {action = "RegisterUrls", controller = "MpesaRegistration"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUrls() on controller DarajaAPI.Controllers.v1.MpesaRegistrationController (DarajaAPI).] []
[2025-05-18 08:29:00.106 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Executed action DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI) in 19467.5871ms] []
[2025-05-18 08:29:00.112 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Executed endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:29:00.121 +03:00] [ERR] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [An unhandled exception has occurred while executing the request.] [System.ArgumentNullException: Value cannot be null. (Parameter 'uriString')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Uri..ctor(String uriString)
   at Program.<>c__DisplayClass0_0.<<Main>$>b__1(HttpClient client) in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Program.cs:line 49
   at Microsoft.Extensions.Http.DefaultHttpClientFactory.CreateClient(String name)
   at DarajaAPI.Services.Daraja.DarajaAuthService.GetAccessTokenAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaAuthService.cs:line 22
   at DarajaAPI.Services.Daraja.DarajaRegistrationService.RegisterUrlsAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaRegistrationService.cs:line 24
   at DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Controllers\v1\MpesaRegistrationController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
]
[2025-05-18 08:29:00.145 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000D] [/api/v1/mpesa/registration/urls] [Request finished HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - 500 null text/plain; charset=utf-8 19531.4684ms] []
[2025-05-18 08:29:07.098 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Request starting HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - null 0] []
[2025-05-18 08:29:07.105 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [CORS policy execution successful.] []
[2025-05-18 08:29:07.108 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Executing endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:29:07.112 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Route matched with {action = "RegisterUrls", controller = "MpesaRegistration"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUrls() on controller DarajaAPI.Controllers.v1.MpesaRegistrationController (DarajaAPI).] []
[2025-05-18 08:29:24.102 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Executed action DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI) in 16983.7934ms] []
[2025-05-18 08:29:24.107 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Executed endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:29:24.114 +03:00] [ERR] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [An unhandled exception has occurred while executing the request.] [System.ArgumentNullException: Value cannot be null. (Parameter 'uriString')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Uri..ctor(String uriString)
   at Program.<>c__DisplayClass0_0.<<Main>$>b__1(HttpClient client) in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Program.cs:line 49
   at Microsoft.Extensions.Http.DefaultHttpClientFactory.CreateClient(String name)
   at DarajaAPI.Services.Daraja.DarajaAuthService.GetAccessTokenAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaAuthService.cs:line 22
   at DarajaAPI.Services.Daraja.DarajaRegistrationService.RegisterUrlsAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaRegistrationService.cs:line 24
   at DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Controllers\v1\MpesaRegistrationController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
]
[2025-05-18 08:29:24.129 +03:00] [INF] [] [0HNCLPAI5CTU8:0000000F] [/api/v1/mpesa/registration/urls] [Request finished HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - 500 null text/plain; charset=utf-8 17030.7346ms] []
[2025-05-18 08:42:52.796 +03:00] [INF] [] [] [] [Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `m`.`Id`, `m`.`BillRefNumber`, `m`.`BusinessShortCode`, `m`.`CreatedAt`, `m`.`FirstName`, `m`.`InvoiceNumber`, `m`.`IsVerified`, `m`.`LastName`, `m`.`MSISDN`, `m`.`MiddleName`, `m`.`OrgAccountBalance`, `m`.`RetryCount`, `m`.`ThirdPartyTransID`, `m`.`TransAmount`, `m`.`TransID`, `m`.`TransTime`, `m`.`TransactionType`, `m`.`VerificationDate`, `m`.`VerificationResult`
FROM `MpesaC2Bs` AS `m`
WHERE NOT (`m`.`IsVerified`) AND (`m`.`CreatedAt` > DATE_ADD(UTC_TIMESTAMP(), INTERVAL CAST(-7.0 AS signed) day))] []
[2025-05-18 08:53:59.764 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Request starting HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - null 0] []
[2025-05-18 08:53:59.770 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [CORS policy execution successful.] []
[2025-05-18 08:53:59.772 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Executing endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:53:59.773 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Route matched with {action = "RegisterUrls", controller = "MpesaRegistration"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterUrls() on controller DarajaAPI.Controllers.v1.MpesaRegistrationController (DarajaAPI).] []
[2025-05-18 08:54:10.677 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Executed action DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI) in 10902.0105ms] []
[2025-05-18 08:54:10.683 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Executed endpoint 'DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls (DarajaAPI)'] []
[2025-05-18 08:54:10.693 +03:00] [ERR] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [An unhandled exception has occurred while executing the request.] [System.ArgumentNullException: Value cannot be null. (Parameter 'uriString')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Uri..ctor(String uriString)
   at Program.<>c__DisplayClass0_0.<<Main>$>b__1(HttpClient client) in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Program.cs:line 49
   at Microsoft.Extensions.Http.DefaultHttpClientFactory.CreateClient(String name)
   at DarajaAPI.Services.Daraja.DarajaAuthService.GetAccessTokenAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaAuthService.cs:line 22
   at DarajaAPI.Services.Daraja.DarajaRegistrationService.RegisterUrlsAsync() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Services\Daraja\DarajaRegistrationService.cs:line 24
   at DarajaAPI.Controllers.v1.MpesaRegistrationController.RegisterUrls() in C:\Users\ianga\source\repos\DarajaIntegration\DarajaAPI\Controllers\v1\MpesaRegistrationController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
]
[2025-05-18 08:54:10.714 +03:00] [INF] [] [0HNCLPAI5CTU9:00000001] [/api/v1/mpesa/registration/urls] [Request finished HTTP/2 POST https://localhost:5003/api/v1/mpesa/registration/urls - 500 null text/plain; charset=utf-8 10950.9954ms] []
